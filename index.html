<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Let's Travel 旅遊套票</title>
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <section class="addTicket-panel">
    <div class="addTicket-img">
      <img src="https://i.imgur.com/iRssPpJ.png" alt="">
      <img src="https://i.imgur.com/vJt0znH.png" alt="">
    </div>
    <form action="" class="addTicket-form">
      <h1 class="title"><span><i class="fas fa-plus-circle"></i></span>新增旅遊套票</h1>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketName">套票名稱</label>
          <input type="text" id="ticketName" placeholder="請填寫套票名稱" name="套票名稱">
        </div>
        <div class="alert-message">
          <p id="ticketName-message" data-message="套票名稱">
            <!--    <i class="fas fa-exclamation-circle"></i>
                      <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketImgUrl">圖片網址</label>
          <input type="text" id="ticketImgUrl" placeholder="請填寫圖片網址" name="圖片網址">
        </div>
        <div class="alert-message">
          <p id="ticketImgUrl-message" data-message="圖片網址">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketRegion">景點地區</label>
          <select id="ticketRegion" name="景點地區">
            <option value="" disabled selected hidden>請選擇景點地區</option>
            <option value="台北">台北</option>
            <option value="台中">台中</option>
            <option value="高雄">高雄</option>
          </select>
        </div>
        <div class="alert-message">
          <p id="ticketRegion-message" data-message="景點地區">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketPrice">套票金額</label>
          <input type="number" id="ticketPrice" placeholder="請填寫套票金額" name="套票金額" min="0">
        </div>
        <div class="alert-message">
          <p id="ticketPrice-message" data-message="套票金額">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketNum">套票組數</label>
          <input type="number" id="ticketNum" placeholder="請填寫套票組數" name="套票組數" min="1">
        </div>
        <div class="alert-message">
          <p id="ticketNum-message" data-message="套票組數">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketRate">套票星級</label>
          <input type="number" id="ticketRate" placeholder="請填寫套票星級" name="套票星級" min="1" max="10">
        </div>
        <div class="alert-message">
          <p id="ticketRate-message" data-message="套票星級">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <div class="form-group">
        <div class="addTicket-input">
          <label for="ticketDescription">套票描述</label>
          <textarea name="套票描述" id="ticketDescription" placeholder="請填寫套票描述 (限 100 字)" maxlength="100"></textarea>
        </div>
        <div class="alert-message">
          <p id="ticketDescription-message" data-message="套票描述">
            <!-- <i class="fas fa-exclamation-circle"></i>
                        <span>必填!</span> -->
          </p>
        </div>
      </div>
      <input type="button" class="addTicket-btn btn" value="新增套票">
    </form>
  </section>
  <section class="main-content">
    <!-- 搜尋區 -->
    <div class="search-area">
      <select name="" class="regionSearch">
        <option value="地區搜尋" disabled selected hidden>地區搜尋</option>
        <option value="">全部地區</option>
        <option value="台北">台北</option>
        <option value="台中">台中</option>
        <option value="高雄">高雄</option>
      </select>
      <p id="searchResult-text">本次搜尋共 3 筆資料</p>
    </div>
    <!-- 套票卡片區 -->
    <ul class="ticketCard-area">
      <li class="ticketCard">
        <div class="ticketCard-img">
          <a href="#">
            <img src="https://i.imgur.com/QXa1fMZ.png" alt="">
          </a>
          <div class="ticketCard-region">高雄</div>
          <div class="ticketCard-rank">10</div>
        </div>
        <div class="ticketCard-content">
          <div>
            <h3>
              <a href="#" class="ticketCard-name">綠島自由行套裝行程</a>
            </h3>
            <p class="ticketCard-description">
              嚴選超高CP值綠島自由行套裝行程，多種綠島套裝組合。
            </p>
          </div>
          <div class="ticketCard-info">
            <p class="ticketCard-num">
              <span><i class="fas fa-exclamation-circle"></i></span>
              剩下最後 <span id="ticketCard-num"> 87 </span> 組
            </p>
            <p class="ticketCard-price">
              TWD <span id="ticketCard-price">$1400</span>
            </p>
          </div>
        </div>
      </li>
      <li class="ticketCard">
        <div class="ticketCard-img">
          <a href="#">
            <img src="https://i.imgur.com/4UHm8WX.png" alt="">
          </a>
          <div class="ticketCard-region">台北</div>
          <div class="ticketCard-rank">2</div>
        </div>
        <div class="ticketCard-content">
          <div>
            <h3>
              <a href="#" class="ticketCard-name">清境高空觀景步道</a>
            </h3>
            <p class="ticketCard-description">
              清境農場青青草原數十公頃碧草，這些景觀豐沛了清境觀景步道的風格，也涵養它無可取代的特色。
            </p>
          </div>
          <div class="ticketCard-info">
            <div class="ticketCard-num">
              <p>
                <span><i class="fas fa-exclamation-circle"></i></span>
                剩下最後 <span id="ticketCard-num"> 99 </span> 組
              </p>
            </div>
            <p class="ticketCard-price">
              TWD <span id="ticketCard-price">$240</span>
            </p>
          </div>
        </div>
      </li>
      <li class="ticketCard">
        <div class="ticketCard-img">
          <a href="#">
            <img src="https://i.imgur.com/H97Wgfn.png" alt="">
          </a>
          <div class="ticketCard-region">台中</div>
          <div class="ticketCard-rank">7</div>
        </div>
        <div class="ticketCard-content">
          <div>
            <h3>
              <a href="#" class="ticketCard-name">山林悠遊套票</a>
            </h3>
            <p class="ticketCard-description">
              山林悠遊套票，結合南投清境高空步道、雙龍瀑布七彩吊橋、瑞龍瀑布園區之熱門景點。
            </p>
          </div>
          <div class="ticketCard-info">
            <div class="ticketCard-num">
              <p>
                <span><i class="fas fa-exclamation-circle"></i></span>
                剩下最後 <span id="ticketCard-num"> 20 </span> 組
              </p>
            </div>
            <p class="ticketCard-price">
              TWD <span id="ticketCard-price">$1765</span>
            </p>
          </div>
        </div>
      </li>
    </ul>
    <!-- 查無關鍵字區 -->
    <div class="cantFind-area">
      <h3>查無此關鍵字資料</h3>
      <img src="https://i.imgur.com/dZI8FJQ.png" alt="">
    </div>
  </section>

  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="all.js"></script>
  <script>
    function showAlertMsg(name) {
      const alertMsg = `<i class="fas fa-exclamation - circle"></i>
        <span> 必填!</span >`;
      let alertSelector = `#${name}-message`;
      document.querySelector(alertSelector).innerHTML = alertMsg;
    }

    function addNewTicket(obj) {
      const newTicket = {
        id: data.length - 1,
        name: obj.ticketName,
        imgUrl: obj.ticketImgUrl,
        area: obj.ticketRegion,
        description: obj.ticketDescription,
        group: obj.ticketNum,
        price: obj.ticketPrice,
        rate: obj.ticketRate
      }
      data.push(newTicket);
    }

    // 地區篩選功能
    const areaFilter = document.querySelector(".regionSearch");
    areaFilter.addEventListener("change", function (e) {
      let str = "";
      let resultNum = 0;

      // 全部地區
      if (e.target.value == "") {
        renderHTML();
        return;
      }
      data.forEach(item => {
        if (e.target.value == item.area) {
          str += printCard(item);
          resultNum += 1;
        }
      });
      list.innerHTML = str;
      printResultText(resultNum);
    })

    // 新增旅遊套票
    const addTicketBtn = document.querySelector(".addTicket-btn");

    // 檢查各個欄位
    addTicketBtn.addEventListener("click", function (e) {
      const container = document.querySelector(".addTicket-form");
      const elements = container.querySelectorAll("div.addTicket-input > input, select, textarea");
      let obj = {};
      let alertNum = 0;

      elements.forEach(elm => {
        let alertMsg = document.querySelector(`#${elm.id}-message`);
        alertMsg.innerHTML = "";  // 先清空

        let elmId = elm.id;
        let elmValue = elm.value.trim();
        if (elmId == "ticketPrice" || elmId == "ticketNum" || elmId == "ticketRate") {
          elmValue = Number(elmValue);
        }

        if (elmValue == "" || elmValue == undefined) {
          showAlertMsg(elmId);
          alertNum++;
        } else {
          obj[elmId] = elmValue;
        }
      })

      // 如果沒有錯誤訊息才增加資料
      if (alertNum == 0) {
        addNewTicket(obj);
        renderHTML();
        swal("新增完成");
        window.scrollTo(0, document.documentElement.scrollHeight);
      }
    })

  </script>
</body>

</html>